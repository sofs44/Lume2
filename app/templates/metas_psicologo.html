{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gerenciar Metas</title>
    <link rel="stylesheet" href="{% static 'css/metas.css' %}">
</head>
<body>
    <header>
        <h1>📝 Gerenciar Metas dos Pacientes</h1>
    </header>

    <main>
        <section class="form-meta">
            <form method="post">
                {% csrf_token %}
                <label for="usuario">Paciente:</label>
                <select name="usuario" id="usuario">
                    {% for usuario in usuarios %}
                        <option value="{{ usuario.id }}">{{ usuario.username }}</option>
                    {% endfor %}
                </select>

                <label for="titulo">Título da Meta:</label>
                <input type="text" name="titulo" id="titulo" required>

                <label for="descricao">Descrição:</label>
                <textarea name="descricao" id="descricao" required></textarea>

                <button type="submit">Criar Meta</button>
            </form>
        </section>

        <section class="meta-lista">
            <h2>Metas já criadas</h2>
            {% if metas %}
                <ul>
                    {% for meta in metas %}
                        <li>
                            <h3>{{ meta.titulo }} ({{ meta.usuario.username }})</h3>
                            <p>{{ meta.descricao }}</p>
                            <small>Criada em {{ meta.data_criacao|date:"d/m/Y" }}</small>
                            <a href="{% url 'editar_meta' meta.id %}" class="btn-editar">Editar</a>
                            <a href="{% url 'excluir_meta' meta.id %}" class="btn-excluir">Excluir</a>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>Nenhuma meta criada ainda.</p>
            {% endif %}
        </section>
    </main>
</body>
</html>
