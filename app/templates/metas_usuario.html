{% extends 'base.html' %}

{% block title %}Metas e Check-in{% endblock %}

{% block content %}
<div class="metas-checkin-container">
  
  <!-- Lista de metas -->
  <div class="metas">
    {% if metas %}
      {% for meta in metas %}
        <div class="meta">
          <div>
            <strong>{{ meta.descricao }}</strong>
            <p>Status: {{ meta.status }}</p>
          </div>
          <form method="post" action="{% url 'metas_usuario' %}">
            {% csrf_token %}
            <input type="hidden" name="meta_id" value="{{ meta.id }}">
            <input type="checkbox" name="marcar_concluida"
              {% if meta.status == 'concluida' %} checked disabled {% endif %}
              onchange="this.form.submit()">
          </form>
        </div>
      {% endfor %}
    {% else %}
      <p>Você ainda não possui metas definidas pelo seu psicólogo.</p>
    {% endif %}
  </div>

  <!-- Check-in emocional -->
  <div class="checkin">
    <div class="emojis">
      <span onclick="mostrarJustificativa()">😢</span>
      <span onclick="mostrarJustificativa()">😡</span>
      <span onclick="mostrarJustificativa()">😐</span>
      <span onclick="mostrarJustificativa()">😊</span>
      <span onclick="mostrarJustificativa()">😁</span>
    </div>
    <textarea class="justificativa" placeholder="Escreva aqui o motivo da sua emoção..."></textarea>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  function mostrarJustificativa() {
    document.querySelector(".justificativa").classList.add("active");
  }
</script>
{% endblock %}
